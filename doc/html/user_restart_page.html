<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Simpatico: 2.9 Restarting</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Simpatico
   &#160;<span id="projectnumber">v1.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a></li><li class="navelem"><a class="el" href="user_page.html">2 User Guide</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">2.9 Restarting </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="user_features_page.html">2.8 Parameter File Options</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_multi_page.html">2.10 Multi-System Simulations</a> (Next) <br />
</p>
<p>All simpatico simulation programs can be restarted from a binary restart file, if such a restart files was output periodically during the original simulation. The option to restart is designed to allow a user to either recover from a failure (caused, e.g., by a hardware failure or a wall-clock limit on a queue) or to continue a simulation that completed successfully.</p>
<p>A restart file preserves the full internal state of a simulation. This includes a great deal of information that is not preserved in a configuration file, including the internal state of statistical accumulators used by on-the-fly analyzers, the internal state of some MD integrators that are based on an extended dynamical system (e.g., Nose-Hoover), and the state of the random number generator. It is designed to allow the simulation to continue as if had not been interrupted.</p>
<h1><a class="anchor" id="user_restart_page_restart"></a>
Writing restart files</h1>
<p>For a simulation to be restartable, the original run periodically write a restart file. Each time a restart file is written, the previous version of the file is overwritten, so that only the most recent verion is available at any instant. The interval (number of time steps) between subsequent file writes is given in the parameter file by an integer parameter named "saveInterval". Output of the restart file may be completely suppressed by setting this parameter to zero. If saveInterval is not zero, the base name of the output file is given by a string parameter "saveFileName." The full name of the output restart file is constructed by appending a suffix ".rst" to this base name.</p>
<p>In parameter files for mcSim or mdSim simulations, the parameters "saveInterval" and (if present) "saveFileName" are the last parameters in main block of the parameter file. They appear just before the closing bracket of the main block, and just after the closing bracket of the AnalyzerManager block. For example, an mcSim or mdSim parameter file that requires the restart file to be written every 10000 time steps to a file named "restart.rst" would thus look in part like this </p><div class="fragment"><div class="line">MdSimulation{</div><div class="line">  ...</div><div class="line">  AnalyzerManager{</div><div class="line">     ...</div><div class="line">  }</div><div class="line">  saveInterval       10000</div><div class="line">  saveFileName       restart</div><div class="line">}</div></div><!-- fragment --><p> where ellipses (...)indicate omitted parts of the file. If saveInterval is set to 0, output of restart file is suppressed. In this case, the "saveFileName" parameter must be omitted. The parameter file for an mdSim simulation with no restart file output would thus look like this: </p><div class="fragment"><div class="line">MdSimulation{</div><div class="line">  ...</div><div class="line">  AnalyzerManager{</div><div class="line">     ...</div><div class="line">  }</div><div class="line">  saveInterval           0</div><div class="line">}</div></div><!-- fragment --><p>In parameter files for ddSim simulations, the parameters saveInterval and (if present) saveFileName appear within the integrator parameter file block. For example, the relevant part of the parameter file for a simulation that write a file named restart.rst every 10000 steps, using a DdMd::NveIntegator, would look like this: </p><div class="fragment"><div class="line">Simulation{</div><div class="line">  ...</div><div class="line">  NveIntegrator{</div><div class="line">    dt                  0.005</div><div class="line">    saveInterval        10000</div><div class="line">    saveFileName        restart</div><div class="line">  }</div><div class="line">  ...</div><div class="line">}</div></div><!-- fragment --><p> As for mcSim and mdSim simulations, writing of restart files may be suppressed by setting saveInterval to 0 and omitting the saveFileName parameter.</p>
<h1><a class="anchor" id="user_restart_page_command"></a>
Command file</h1>
<p>When a simulation is restarted, it first reads the restart (*.rst) file to recreate the internal state of the simulation, and then begins reading a separate command file. The name of the command file for a restarted simulation must begin with the same base name as the corresponding *.rst restart file, followed by a file extension ".cmd" (for "command"). For example, these two files might be named "restart.rst" and "restart.cmd". Because the paths to the restart (*.rst) file and command (*.cmd) file can only differ by the file extension, they must be in the same directory. For either single-processor or parallel MD simulations of a single system, both files are normally in the directory from which the program is executed.</p>
<p>The first line of command file for a restarted simulation must contain a RESTART command. The RESTART takes an integer argument, which is the desired final value of the step counter. This command causes the simulation to re-enter the main simulation loop at the point at which the restart file was written, with the step counter set to the value it had when that file was written, and then run until the counter reaches the final value given as an argument to RESTART command. The RESTART command may be followed by any number of other commands. As in any command file, the last command must be a "FINISH" command, which terminates execution.</p>
<p>For example, command file required to restart a simulation and continue until the step counter reaches 150000, and then terminate, would thus look like this: </p><div class="fragment"><div class="line">RESTART   150000</div><div class="line">FINISH</div></div><!-- fragment --><p> Other commands may also appear before the initial RESTART command and the final FINISH command, in order to, e.g., write the final configuration to a configuration file, or change parameters and run another simulation.</p>
<p>The RESTART command is only valid in a simulation that was executed using the -r command line option, in which case it must be the first line of the command file.</p>
<h1><a class="anchor" id="user_restart_usage_section"></a>
Restarting - command line usage</h1>
<p>To restart a simulation, one must thus invoke the mcSim, mdSim, or ddSim executable with the -r option, passing it the name of a restart file as an argument. The name of the command file is passed as an argument to the -c option, as usual. Thus, for example, if a previous mcSim MC simulation were run using a base name of "restart" for the saveFileName, and the restart command file is named restart.cmd, one could type </p><div class="fragment"><div class="line">mcSim -r restart -c restart.cmd</div></div><!-- fragment --><p> to restart the simulation. In the above example, the -r option would cause the program to read a file named restart.rst to initialize the simulation, and then execute the commands in a file named restart.cmd. The same command line syntax is used for all three programs.</p>
<p>To restart a ddSim simulation, one must, of course, also launch an MPI environment. To continue simulation that uses 8 processors, using a restart named restart and and command file named restart.cmd, one might thus enter: </p><div class="fragment"><div class="line">mpirun -np 8 ddSim -r restart -c restart.cmd</div></div><!-- fragment --><p> To continue a ddSim simulation, the number of processors must be the same as that used in the original simulation.</p>
<p>The -r option may be combined with the -e option. This causes parameters that would normally be read from the parameter file to be echoed to standard output as they are read from the restart file.</p>
<p><br />
 <a class="el" href="user_features_page.html">2.8 Parameter File Options</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_page.html">2 User Guide</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="user_multi_page.html">2.10 Multi-System Simulations</a> (Next) </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.3-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jan 8 2017 23:13:22 for Simpatico by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
