<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Simpatico: Langevin Integration</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Simpatico
   &#160;<span id="projectnumber">v1.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a></li><li class="navelem"><a class="el" href="user_page.html">2 User Guide</a></li><li class="navelem"><a class="el" href="user_features_page.html">2.8 Parameter File Options</a></li><li class="navelem"><a class="el" href="user_features_ddmd_page.html">2.8.2 Options for ddSim</a></li><li class="navelem"><a class="el" href="ddMd_integrators_page.html">Molecular Dynamics Integrators</a></li><li class="navelem"><a class="el" href="ddMd_integrator_NvtLangevinIntegrator_page.html">NvtLangevinIntegrator</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">Langevin Integration </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>The classes <a class="el" href="classMcMd_1_1NvtLangevinIntegrator.html" title="A NVT molecular dynamics integrator with a Langevin thermostat. ">McMd::NvtLangevinIntegrator</a> and <a class="el" href="classDdMd_1_1NvtLangevinIntegrator.html" title="A NVT molecular dynamics integrator with a Langevin thermostat. ">DdMd::NvtLangevinIntegrator</a> compute approximate solutions to the Langevin equation. This page describe the time stepping algorithm used by both of these classes.</p>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="classMcMd_1_1NvtLangevinIntegrator.html" title="A NVT molecular dynamics integrator with a Langevin thermostat. ">McMd::NvtLangevinIntegrator</a> </dd>
<dd>
<a class="el" href="classDdMd_1_1NvtLangevinIntegrator.html" title="A NVT molecular dynamics integrator with a Langevin thermostat. ">DdMd::NvtLangevinIntegrator</a></dd></dl>
<h1><a class="anchor" id="algorithms_Langevin_equation_sec"></a>
Langevin Equation</h1>
<p>The Langevin equation for each particle is given by Newton's equation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ m\frac{d{\bf v}}{dt} = {\bf f} \]" src="form_135.png"/>
</p>
<p> with a force </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf f} = -\frac{\partial U}{\partial {\bf r}} - m\gamma {\bf v} + {\bf f}^{\rm (r)} , \]" src="form_136.png"/>
</p>
<p> that includes frictional and random components, in which:</p>
<ul>
<li><img class="formulaInl" alt="$m$" src="form_127.png"/> is the particle mass</li>
<li><img class="formulaInl" alt="${\bf v}$" src="form_134.png"/> is the particle velocity</li>
<li><img class="formulaInl" alt="$\gamma$" src="form_115.png"/> is a velocity relaxation rate (inverse time) parameter</li>
<li><img class="formulaInl" alt="${\bf f}^{\rm (r)}$" src="form_116.png"/> is a random force.</li>
</ul>
<p>The random force must have a mean and auto-correlation function: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \langle {\bf f}^{\rm (r)}\rangle &amp; = &amp; 0 \\ \langle {\bf f}^{\rm (r)}(t) {\bf f}^{\rm (r)}(t') \rangle &amp; = &amp; 2 m kT \gamma \delta (t-t') . \end{eqnarray*}" src="form_137.png"/>
</p>
 <h1><a class="anchor" id="algorithms_Langevin_discrete_sec"></a>
Integration Algorithm</h1>
<p>The algorithm uses a conventional two-step velocity-Verlet time stepping sequence, identical to that of of the energy conserving NVE integrators, with a modified total force. This algorithm uses the following two-step update scheme for the velocity <img class="formulaInl" alt="${\bf v}(n)$" src="form_138.png"/> and position <img class="formulaInl" alt="${\bf r}(n)$" src="form_139.png"/>: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\begin{eqnarray*} \overline{\bf v}(n) &amp; = &amp; {\bf v}(n) + {\bf f}(n) \Delta t /(2m) \\ {\bf r}(n+1) &amp; = &amp; {\bf r}(n) + \overline{\bf v}(n)\Delta t \\ {\bf f}(n+1) &amp; = &amp; {\bf f}(\;{\bf r}(n+1),\; \overline{\bf v}(n)\; ) \\ {\bf v}(n+1) &amp; = &amp; \overline{\bf v}(n) + {\bf f}(n+1)\Delta t /(2m) \\ \end{eqnarray*}" src="form_140.png"/>
</p>
<p> The total force <img class="formulaInl" alt="${\bf f}$" src="form_141.png"/> is given by a function </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf f}(n+1) = {\bf f}^{\rm (pot)}(n+1) + c_{v}\overline{\bf v}(n) + c_{r}{\bf u}(n+1), \]" src="form_142.png"/>
</p>
<p> in which <img class="formulaInl" alt="${\bf f}^{\rm (pot)}(n+1)$" src="form_143.png"/> is the conservative force derived from the potential energy, evaluated at updated position <img class="formulaInl" alt="${\bf r}(n+1)$" src="form_144.png"/>, <img class="formulaInl" alt="$c_{v}$" src="form_145.png"/> and <img class="formulaInl" alt="$c_{r}$" src="form_146.png"/> are numerical coefficients whose values are determined below, and <img class="formulaInl" alt="${\bf u}$" src="form_147.png"/> is a dimensioness random number whose Cartesian components are each uniformly distributed random numbers in the range <img class="formulaInl" alt="$[-1/2, 1/2]$" src="form_148.png"/>.</p>
<p>Because the force <img class="formulaInl" alt="${\bf f}(n+1)$" src="form_149.png"/> is calculated between the first step of this two-step integrator (i.e., first two lines of the above algorithm) and the final velocity update (the last line), it contains a conservative force that is calculated using fully updated positions <img class="formulaInl" alt="${\bf r}(n+1)$" src="form_144.png"/> but a frictional drag force calculated using the half-updated velocity <img class="formulaInl" alt="$\overline{\bf v}(n)$" src="form_150.png"/>. In practice, the drag and random forces for each particle are evaluated and added to the total force for that particle at the beginning of the loop over particles for second step of the algorithm, after evaluation of the conservative forces for all particles.</p>
<p>Determination of Coefficients: The coefficients <img class="formulaInl" alt="$c_{v}$" src="form_145.png"/> and <img class="formulaInl" alt="$c_{r}$" src="form_146.png"/> are chosen so that in the absence of any potential force (i.e., in an ideal gas) the algorithm would yield the exact result for the decay of velocity correlations and for the variance of the velocity obtained at the end of each step. In an ideal gas, the velocity change between midstep force evaluations is given by </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \overline{\bf v} (n+1) = ( 1 + c_{v} \Delta t/m )\overline{\bf v}(n) + (c_{r}\Delta t/m) {\bf u} \]" src="form_151.png"/>
</p>
<p> By convention, we choose the constant <img class="formulaInl" alt="$c_{v}$" src="form_145.png"/> such that <img class="formulaInl" alt="$1 + c_{v}\Delta t/m = e^{-\gamma\Delta t}$" src="form_152.png"/>, where <img class="formulaInl" alt="$\gamma$" src="form_115.png"/> is a decay rate parameter input by the user. This yields the decay of velocity auto-correlations between midstep velocities predicted by the exact solution. This gives a coefficient </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ c_{v} = -m (1 - e^{-\gamma\Delta t})/\Delta t , \]" src="form_153.png"/>
</p>
<p> for which <img class="formulaInl" alt="$c_{v} &lt; 0$" src="form_154.png"/>. The coefficient <img class="formulaInl" alt="$c_{r}$" src="form_146.png"/> for the random force is then chosen so that, in the absence of conservative forces, the mapping would produce a variance for the end of step velocities that satisfies the equipartition theorem </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \langle v_{i} v_{j} \rangle = \delta_{ij} k_{B}T/m , \]" src="form_155.png"/>
</p>
<p> Because there are systematic differences between the mid-step and end-of-step velocities, this turns out to imply that the mid-step velocities obey a modified equation </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ \langle \overline{v}_{i} \overline{v}_{j} \rangle = \delta_{ij} d k_{B}T/m . \]" src="form_156.png"/>
</p>
<p> in which <img class="formulaInl" alt="$d$" src="form_157.png"/> is a coefficient that approaches unity only in the continuum limit <img class="formulaInl" alt="$\gamma\Delta t \rightarrow 0$" src="form_158.png"/>. Applying the above criteria for the variance of the midstep velocities, while treating <img class="formulaInl" alt="$d$" src="form_157.png"/> for now as unknown, and using the identity <img class="formulaInl" alt="$\langle u_{i} u_{j} \rangle = \delta_{ij}/12$" src="form_159.png"/> for the Cartesian components of <img class="formulaInl" alt="${\bf u}$" src="form_147.png"/>, we obtain: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ c_{r} = \sqrt{12 m k_{B}T d ( 1 - e^{-2\gamma\Delta t})}/\Delta t \]" src="form_160.png"/>
</p>
<p> To determine <img class="formulaInl" alt="$d$" src="form_157.png"/>, we then use the mapping </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ {\bf v}(n+1) = [1 + c_{v}\Delta t/(2m)] \overline{\bf v}(n) + [c_{r} \Delta t/(2m)] {\bf u}(n+1) \]" src="form_161.png"/>
</p>
<p> for an ideal gas to calculate the relationship between variances for midstep and final velocities, and require that the end-of-step velocities satisfy equipartition. This yields: </p><p class="formulaDsp">
<img class="formulaDsp" alt="\[ d = 2/(1 + e^{-\gamma\Delta t}) . \]" src="form_162.png"/>
</p>
<p> Substituting this into the equation for <img class="formulaInl" alt="$c_{r}$" src="form_146.png"/> completes the specification of constants in the algorithm.</p>
<p>Because the values of the coefficients <img class="formulaInl" alt="$c_{v}$" src="form_145.png"/> and <img class="formulaInl" alt="$c_{r}$" src="form_146.png"/> depend on the particle mass, values must be calculated for each atom type. These values are stored in private arrays named cv_ and cr_ that are indexed by atom type id. </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.3-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jan 8 2017 23:13:22 for Simpatico by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
