<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Simpatico: 2.2.4 Configuring MPI</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Simpatico
   &#160;<span id="projectnumber">v1.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a></li><li class="navelem"><a class="el" href="user_page.html">2 User Guide</a></li><li class="navelem"><a class="el" href="user_compile_page.html">2.2 Compiling</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">2.2.4 Configuring MPI </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="user_compile_configure_page.html">2.2.3 Configuring simpatico</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_compile_outsource_page.html">2.2.5 Compiling (Out-of-Source)</a> (Next) <br />
</p>
<p>The simpatico package contains code for several programs that are parallelized with MPI (the Message Passing Interface). Specifically, the ddSim parallel domain decomposition program and the embarassingly parallel versions of the mcSim and mdSim single processor programs all require MPI. The user must thus make sure that an MPI library is installed and accessible on a particular system before attempting to compile these programs on that system.</p>
<p>The choice of an MPI library is related to the choice of compiler used to compile simpatico: Generally, simpatico should be compiled using the same compiler as that used to compile the MPI library to which simpatico will be linked.</p>
<p>The simpatico programs that require MPI are intended to be used on linux clusters that typically contain many processor cores and multiple nodes. These programs can, however, also be compiled on a desktop or laptop computer with a unix-like operating system if an MPI library is installed. One reason to compile the parallel simpatico programs on a desktop or laptop is to simplify development and initial testing of new features. The parallel simpatico programs have been developed and tested on several linux systems, including multi-user clusters and deskop computers, and on Macintosh laptop and desktop computers. This page includes comments about how to enable or (if necessary) install an MPI on several different types of systems.</p>
<h1><a class="anchor" id="compile_mpi_mpicxx"></a>
Usage of the mpicxx script</h1>
<p>By default, when compiling programs that require MPI, the simpatico build system invokes the C++ compiler through a wrapper script named "mpicxx". A script with this name is provided by several of the most common MPI libraries. If present, the "mpicxx" script invokes the compilerthat was used to compile the MPI library with any options that are needed to specify the locations of MPI header and library files, in addition to any options that are specified explicitly by the user. This script should be installed and configured when an MPI library is compiled and installed, or when an appropriate software module is loaded (see below).</p>
<p>If you are working on a machine on which you think that MPI may already be installed and accessible, and want to check for the presence of an accessible "mpicxx" script, simply enter </p><div class="fragment"><div class="line">&gt; which mpicxx</div></div><!-- fragment --><p> If this command returns a path to an executable file named "mpicxx", then an MPI library is presumably already installed, and you can try to proceed with compilation using this MPI library. If this command returns an empty string, then you may have to install an MPI library.</p>
<h1><a class="anchor" id="compile_mpi_cluster"></a>
Multi-User Linux Clusters</h1>
<p>On any multi-user linux cluster that is set up for use in computational research, at least one MPI library should already be installed. At the University of Minnesota, simpatico is often run on cluster provided by the Minnesota Supercomputer Institute (MSI). Cluster at MSI allow the users to choose from among several different choices of MPI library and compiler.</p>
<p>The computer clusters at MSI, like many similar clusters, use the linux "module" command to allow users to load particular software packages, including compilers and MPI libraries. The "module" command is the user interface to the "Modules" package, which is a system for automating changes in a users unix shell environment that are required in order to use particular software packages. The command </p><div class="fragment"><div class="line">&gt; module avail</div></div><!-- fragment --><p> should give a listing of all softwared modules available for use on a particular system. The syntax for the command to load a particular module is </p><div class="fragment"><div class="line">&gt; module load  module-name</div></div><!-- fragment --><p> where module-name represents the name of a particular software module, as listed by the module avail command.</p>
<p>On the mesabi cluster at MSI, to load a version of the OpenMPI library that was compiled with the curent default version of the intel compiler, one enters the command: </p><div class="fragment"><div class="line">&gt; module load ompi/intel</div></div><!-- fragment --><p> This command also makes the intel compiler the default compiler for use when compiling code that uses MPI. To instead use OpenMPI with the gnu gcc compiler, and make the gcc compiler the default for MPI code, instead enter </p><div class="fragment"><div class="line">&gt; module load ompi/gnu</div></div><!-- fragment --><p> There are also many modules on mesabi to load specific versions of OpenMPI with specific versions of either compiler, as well as modules to load the mpich MPI library compiled with specific compilers.</p>
<h1><a class="anchor" id="compile_mpi_Ubuntu"></a>
Ubuntu Linux</h1>
<p>MPI is not normally installed by default on a linux desktop or laptop. To install the OpenMPI MPI library on a computer that is running the Ubuntu linux distribution, use the apt-get package manager by entering: </p><div class="fragment"><div class="line">&gt; sudo apt-<span class="keyword">get</span> --yes install openmpi-bin</div><div class="line">&gt; sudo apt-<span class="keyword">get</span> --yes install libopenmpi-dev</div><div class="line">&gt; sudo apt-<span class="keyword">get</span> --yes install libopenmpi1.6</div></div><!-- fragment --><p> After compiling MPI by this method, you should be able to compile parallel simpatico programs using the gcc compiler and default configuration settings (COMPILER=gcc, OS=generic).</p>
<h1><a class="anchor" id="compile_mpi_Mac"></a>
Mac OS X</h1>
<p>Below we describe how to install an openMPI library on a MacIntosh computer running OS X using either of two different systems for managing unix software packages on OS X.</p>
<h2><a class="anchor" id="compile_mpi_MacBrew"></a>
Mac OS X - Homebrew Package Manager</h2>
<p>To install the OpenMpi library on Mac OS X by using the Homebrew package manager, enter </p><div class="fragment"><div class="line">&gt; brew install openmpi</div></div><!-- fragment --><p> After installing OpenMPI by this route, we have had no trouble compiling simpatico programs that use MPI using the gcc compiler and default configuration settings (COMPILER=gcc, OS=generic).</p>
<h2><a class="anchor" id="compile_mpi_MacPort"></a>
Mac OS X - MacPort Package Manager</h2>
<p>To install OpenMpi on a Mac OS X system on which the MacPorts system is being used to manage linux packages, simply enter </p><div class="fragment"><div class="line">&gt; sudo port install openmpi</div></div><!-- fragment --><p> In order to make changes to compiler options that we find are necessary to compile and link with the resulting configuration, set the makefile variable OS to OS=mac-port in the main config.mk file, either by invoking the command </p><div class="fragment"><div class="line">&gt;./configure -o mac-port</div></div><!-- fragment --><p> from the simpatico/ root directory or the relevant build directory, or by manually editing the main config.mk configuration file in the relevant build directory.</p>
<p>Setting OS=mac-port changes the options that are passed to the compiler so as to explicitly pass the paths for MPI header and library files to the compiler. This appeared to be necessary on the iMac on which we tested this because the MacPorts system installs header and library files in non-standard locations within the /opt/ directory, and because the configuration of the "mpicxx" script created by MacPorts does not seem to automatically invoke the compiler with options that specify these paths (as it should).</p>
<p><br />
 <a class="el" href="user_compile_configure_page.html">2.2.3 Configuring simpatico</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_compile_page.html">2.2 Compiling</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="user_compile_outsource_page.html">2.2.5 Compiling (Out-of-Source)</a> (Next) </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.3-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Mar 7 2018 12:59:45 for Simpatico by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
