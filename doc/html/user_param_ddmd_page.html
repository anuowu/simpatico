<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Simpatico: 2.4.3 Parameter Files: ddSim</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Simpatico
   &#160;<span id="projectnumber">v1.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a></li><li class="navelem"><a class="el" href="user_page.html">2 User Guide</a></li><li class="navelem"><a class="el" href="user_param_page.html">2.4 Parameter Files</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">2.4.3 Parameter Files: ddSim </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="user_param_mcmd_page.html">2.4.2 Parameter Files: mdSim and mcSim</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_commands_page.html">2.5 Command Files</a> (Next) <br />
</p>
<h1><a class="anchor" id="param_ddMd_example_section"></a>
Example (ddSim):</h1>
<p>Below is an example parameter file for a simple NVE ddSim parallel MD simulation for simulating a relatively small system (up 20000 atoms) on 8 processors in a 2 x 2 x 2 processor grid. </p><div class="fragment"><div class="line">Simulation{</div><div class="line">  Domain{</div><div class="line">    gridDimensions    2    2    2</div><div class="line">  }</div><div class="line">  FileMaster{</div><div class="line">    commandFileName   commands</div><div class="line">    inputPrefix       in/</div><div class="line">    outputPrefix      out/</div><div class="line">  }</div><div class="line">  nAtomType           1</div><div class="line">  nBondType           1</div><div class="line">  atomTypes           A    1.0</div><div class="line">  AtomStorage{</div><div class="line">    atomCapacity      12000</div><div class="line">    ghostCapacity     12000</div><div class="line">    totalAtomCapacity 20000</div><div class="line">  }</div><div class="line">  BondStorage{</div><div class="line">    capacity          10000</div><div class="line">    totalCapacity     20000</div><div class="line">  }</div><div class="line">  Buffer{</div><div class="line">    atomCapacity       2000</div><div class="line">    ghostCapacity      2000</div><div class="line">  }</div><div class="line">  pairStyle           LJPair</div><div class="line">  bondStyle           HarmonicBond</div><div class="line">  maskedPairPolicy    maskBonded</div><div class="line">  reverseUpdateFlag   0</div><div class="line">  PairPotential{</div><div class="line">    epsilon           1.0</div><div class="line">    sigma             1.0</div><div class="line">    cutoff            1.122462048</div><div class="line">    skin              0.4</div><div class="line">    pairCapacity      40000</div><div class="line">    maxBoundary       orthorhombic   30.0   30.0   30.0</div><div class="line">  }</div><div class="line">  BondPotential{</div><div class="line">    kappa             400.0</div><div class="line">    length            1.000</div><div class="line">  }</div><div class="line">  EnergyEnsemble{</div><div class="line">    type              adiabatic</div><div class="line">  }</div><div class="line">  BoundaryEnsemble{</div><div class="line">    type              rigid</div><div class="line">  }</div><div class="line">  NveIntegrator{</div><div class="line">    dt                0.005</div><div class="line">    saveInterval      0</div><div class="line">  }</div><div class="line">  Random{</div><div class="line">    seed              8012457890</div><div class="line">  }</div><div class="line">  AnalyzerManager{</div><div class="line">     baseInterval     1000</div><div class="line"></div><div class="line">     OutputEnergy{</div><div class="line">        interval        1000</div><div class="line">        outputFileName  energy</div><div class="line">     }</div><div class="line"></div><div class="line">     OutputPressure{</div><div class="line">        interval        1000</div><div class="line">        outputFileName  pressure</div><div class="line">     }</div><div class="line"></div><div class="line">  }</div><div class="line">}</div></div><!-- fragment --><p>In outline form, the format is </p><div class="fragment"><div class="line">Simulation{</div><div class="line">  Domain{ ... }</div><div class="line">  FileMaster{ ... }</div><div class="line">  nAtomType           1</div><div class="line">  nBondType           1</div><div class="line">  atomTypes           [string(name)]  [float(masss)]</div><div class="line">                      ...</div><div class="line">  AtomStorage{ ... }</div><div class="line">  BondStorage{ ... }</div><div class="line">  Buffer{ ... }</div><div class="line">  pairStyle           [string]</div><div class="line">  bondStyle           [string]</div><div class="line">  maskedPairPolicy    [string]</div><div class="line">  reverseUpdateFlag   [bool (0 or 1)]</div><div class="line">  PairPotential{ ... }</div><div class="line">  BondPotential{ ... }</div><div class="line">  EnergyEnsemble{ ... }</div><div class="line">  BoundaryEnsemble{ ... }</div><div class="line">  NveIntegrator{ ... }</div><div class="line">  Random{ ... }</div><div class="line">  AnalyzerManager{ ... }</div><div class="line">}</div></div><!-- fragment --><p> The main Simulation{} block in a ddSim simulation is associated with a <a class="el" href="classDdMd_1_1Simulation.html" title="Main object for a domain-decomposition MD simulation. ">DdMd::Simulation</a> object. In a ddSim simulation, no distinction is made between a "Simulation" and a "System", and so there is no analog of the MdSystem or McSystem sub-blocks that appear in the mdSim and mcSim param files.</p>
<p>Many parameters and parameter blocks in this format are similar to those in mcSim and mdSim parameter files. The variables nAtomType, atomTypes, maskedPairPolicy, pairStyle, nBondType, bondStyle all have meaning as the corresponding parameters in mcSim and mdSim parameter files. So do corresponding variables associated with angles (nAngleType and nAngleStyle) and dihedral (nDihedralGroup and dihedralStyle) that do not appear in this example. The FileMaster, Random, EnergyEnsemble, and BoundaryEnsemble blocks are all identical to corresponding blocks in mcSim and mdSim parameter files.</p>
<p>The PairPotential and BondPotential blocks in this example are associated with instances of <a class="el" href="classDdMd_1_1PairPotential.html" title="Abstract base class for computing nonbonded pair forces and energies. ">DdMd::PairPotential</a> and <a class="el" href="classDdMd_1_1BondPotential.html" title="Abstract base class for computing bond forces and energies. ">DdMd::BondPotential</a>, respectively These blocks take the same parameters as the MdPairPotential and BondPotential blocks of an mdSim simulation. The same pair and bond style strings are valid here as an mdSim or mcSim simulation. If the ddSim executable has been compiled with angle, dihedral, and/or external potentials enabled, and if one or more of these potentials has been enabled at run time by specifying nonzero values for nAngleType, nDihedralType or hasExternalPotential, then the PairPotential and BondPotential blocks must be followed by AnglePotential, DihedralPotential, and/or ExternalPotential blocks, as appropriate.</p>
<p>The AnalyzerManager block is associated with an instance of <a class="el" href="classDdMd_1_1AnalyzerManager.html" title="Manager for a list of Analyzer objects. ">DdMd::AnalyzerManager</a>, and has a format similar to that of the corresponding block in a mdSim or mcSim parameter file. This block must contain a value for the baseInterval, followed by zero or more polymorphic blocks, each of which contains the parameter block for a subclass of <a class="el" href="classDdMd_1_1Analyzer.html" title="Abstract base for periodic output and/or analysis actions. ">DdMd::Analyzer</a>. The number of analyzers that are provided for use on-the-fly during ddSim simulations is thus far much smaller than the number avaiable for mdSim and mcSim simulations. This is partly a result of lack of time, and partly because some analyzers that are easy to implement in single-processor simulations are more difficult to implement efficiently in a parallel simulation.</p>
<h1><a class="anchor" id="user_param_reverseUpdateFlag_section"></a>
reverseUpdateFlag</h1>
<p>The reverseUpdateFlag is a bool variable whose value determines which of two communication patterns should be used in algorithm used to communicate particle data between neighboring processors. It should usually be set to zero. A value of 1 enables an algorithm in which the forces for each nonbonded or bonded group of particles in which particles are owned by different processors is calculated on only processor. This requires the resulting forces to then be communicate to the other processors via a separate "reverseUpdate" communication step. A value of 0 (the default) enables and algorithm in which this calculation is replicated on every processor that owns an atom within a group, which avoids the need to communicate forces arising from such group in a separate communication step. The reserveUpdate algorithm will be necessary for some integrators, but is generally slightly slower.</p>
<h1><a class="anchor" id="user_param_Domain_section"></a>
Domain</h1>
<p>The Domain block is associated with a <a class="el" href="classDdMd_1_1Domain.html" title="Decomposition of the system into domains associated with processors. ">DdMd::Domain</a> object. This object defines a processor grid, and controls the pattern of communication between neighboring processors within the grid. In the domain decomposition algorithm used by ddSim, the periodic simulation cell is divided into a regular grid of spatial domains, each of which is assigned to a different processor. The gridDimensions parameter is a vector of 3 integers (a <a class="el" href="classUtil_1_1IntVector.html" title="An IntVector is an integer Cartesian vector. ">Util::IntVector</a>) that defines the dimensions of this grid (the number of processors) along each of the three spatial directions. The product of these three integers gives the total number of processors, which must agree with the number of processors that is requested from the operating system in the command line that runs the executable.</p>
<h1><a class="anchor" id="user_param_Storage_section"></a>
AtomStorage and BondStorage</h1>
<p>The AtomStorage and BondStorage blocks are associated with <a class="el" href="classDdMd_1_1AtomStorage.html" title="A container for all the atoms and ghost atoms on this processor. ">DdMd::AtomStorage</a> and <a class="el" href="classDdMd_1_1BondStorage.html" title="Container for for Group&lt;2&gt; (bond) objects. ">DdMd::BondStorage</a> objects. An AtomStorage is a container that holds <a class="el" href="classDdMd_1_1Atom.html" title="A point particle in an MD simulation. ">DdMd::Atom</a> objects for one processor. A BondStorage is a container that instead holds objects that represent covalent bonds, each of which contains references to two atoms. The parameter file for a ddSim simulation with angle and dihedral potentials enabled would also have AngleStorage and DihedralStorage blocks associated with containers for 3-body and 4-body covalent groups.</p>
<p>An AtomStorage maintains separate lists of two types of atoms. Local atoms are atoms that are "owned" by a processor. "Ghost" atoms are atoms that are "owned" by neighboring processors, but that are close enough to the boundaries between processor domains to interact with atoms owned by this processor.</p>
<p>The storage classes allocate blocks of memory at the beginning of a simulation, using "capacity" parameters that are specified by the user. The atomCapacity and ghostCapacity parameters gives the maximum number of local atoms and ghost atoms that can be accomodated on a single processor. The totalAtomCapacity is the maximum value for the total number of atoms on all processors. In the BondStorage block, capacity parameter gives the maximum total number of bonds on one processor, and totalCapacity gives the total number of bonds on all processors. Bonds (and other covalent groups, if used) are maintained in a single list that contains every bond that involves at least one atom that is owned by the processor.</p>
<p>The atomCapacity, ghostCapacity, and bondCapacity parameters must be chosen by the user to be large enough to accomodate any fluctuations in the number of atoms per processor. In a dense liquid containing a few thousand particles per processor, it is usually more than sufficient to set these capacities to be twice expected the average values, but a bit of experimentation is sometimes helpful. The totalAtomCapacity and totalBondCapacity must be greater tha or equal to than the total number of atoms or bonds, respectively, in the associated input configuration file. Using input values roughly twice these maximum values normally provides sufficient safety.</p>
<p>The log output produced by a ddSim simulation lists the actual maximum number of local atom and ghost atoms encountered on any processor during a simulation. Before running large simulations of a particular system, it is useful to run some short simulations and use these reported maximum values as a guide to the choice of appropriate (larger) capacity parameters.</p>
<h1><a class="anchor" id="user_param_Buffer_section"></a>
Buffer</h1>
<p>The Buffer block is associated with a <a class="el" href="classDdMd_1_1Buffer.html" title="Buffer for interprocessor communication. ">DdMd::Buffer</a> object that provides memory that is used for interprocessor communication. The atomCapacity parameters specify the maximum number of local atoms that may be communicated at once between neighboring processors when ownership is exchanged. Atom ownership is exchanged only when the neighbor list is rebuilt, which typically occurs about everten time steps. The ghostCapacity specifies the maximum number of ghost atom positions to be communicated at once between neighboring processors after every time step. These two parameters are used to decide how large a block of memory to allocate for use in interprocessor communication.</p>
<p>When setting up a first simulation for a particular system, one can be conservative and set these values larger than is expected to be necessary, e.g., by setting both parameters greater than or equal to the average total number of atoms per processor. If needed, values output in the log file for the maximum values of these parameters actually encountered during an initial simulation can then be used to adjust parameter values used in subsequent runs.</p>
<h1><a class="anchor" id="user_param_DdMdIntegrator_section"></a>
MD Integrator</h1>
<p>The NveIntegrator block in the above example is a polymorphic block that must contain the file format for a subclass of <a class="el" href="classDdMd_1_1Integrator.html" title="An Integrator numerically integrates the equations of motion. ">DdMd::Integrator</a>. Each subclass of <a class="el" href="classDdMd_1_1Integrator.html" title="An Integrator numerically integrates the equations of motion. ">DdMd::Integrator</a> implements a parallel MD integrator. The <a class="el" href="classDdMd_1_1NveIntegrator.html" title="A velocity-Verlet constant energy integrator. ">DdMd::NveIntegrator</a> class used in the above example implements a simple NVE velocity-Verlet algorithm. The most important parameter required for this integrator is a value for the time step size dt. The required parameters are different for different integrators, but always include a value for dt.</p>
<p>The Integrator block also contains a parameter saveInterval, which controls the frequency with which a restart (or checkpoint) file is rewritten. Setting saveInterval = 0, as in the above example, suppresses writing of the checkpoint file. The restart system is discussed in more detail in Sec. <a class="el" href="user_restart_page.html">2.10 Restarting</a>.</p>
<p><br />
 <a class="el" href="user_param_mcmd_page.html">2.4.2 Parameter Files: mdSim and mcSim</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="user_param_page.html">2.4 Parameter Files</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="user_commands_page.html">2.5 Command Files</a> (Next) </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.3-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Wed Mar 7 2018 12:59:45 for Simpatico by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
