<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>Simpatico: 4.7 Modules</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
<link href="customdoxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Simpatico
   &#160;<span id="projectnumber">v1.10</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
    </ul>
  </div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="index.html">Simpatico - Simulation Package for Polymer and Molecular Liquids</a></li><li class="navelem"><a class="el" href="extend_page.html">4 Extending Simpatico</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">4.7 Modules </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p><a class="el" href="extend_subfactory_page.html">4.5 Sub-Factories</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="developer_page.html">5 Developer Information</a> (Next) <br />
</p>
<p>A module is a class that encapsulates a set of classes that were designed for a specific application area, along with a set of factory classes that are required to allow the new classes to be used within the parameter files. The classes <a class="el" href="classMcMd_1_1McModule.html" title="Abstract Module for an McSimulation. ">McModule</a> and <a class="el" href="classMcMd_1_1MdModule.html" title="A Module for an MdSimulation. ">MdModule</a> are abstract base classes for modules designed for use with with mcSim and mdSim simulations, respectively. The developer of a new set of subclasses of, e.g., <a class="el" href="classMcMd_1_1Analyzer.html" title="Abstract base for periodic output and/or analysis actions. ">Analyzer</a>, <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules. ">Species</a>, and <a class="el" href="classMcMd_1_1McMove.html" title="McMove is an abstract base class for Monte Carlo moves. ">McMove</a> or <a class="el" href="classMcMd_1_1MdIntegrator.html" title="Abstract base for molecular dynamics integrators. ">MdIntegrator</a>, can create a subclass of <a class="el" href="classMcMd_1_1McModule.html" title="Abstract Module for an McSimulation. ">McModule</a> and/or <a class="el" href="classMcMd_1_1MdModule.html" title="A Module for an MdSimulation. ">MdModule</a> to organize these classes. Once the developer creates a module, a user of Simpatico can use an instance of the module class to make this entire set of classes accessible in a simulation.</p>
<p>The <a class="el" href="classMcMd_1_1McModule.html" title="Abstract Module for an McSimulation. ">McModule</a> class is defined as follows: </p><div class="fragment"><div class="line"><span class="keyword">class </span>McModule {</div><div class="line"><span class="keyword">public</span>:</div><div class="line"></div><div class="line">   <a class="code" href="classMcMd_1_1McModule.html#a20788144eedcc30dcda8e25b3801863e">McModule</a>(McSimulation&amp; simulation);</div><div class="line"></div><div class="line">   <a class="code" href="classMcMd_1_1McModule.html#a6cd7ba14b94b5e72e355ea8d3f1a23cd">~McModule</a>();</div><div class="line"></div><div class="line">   <span class="keyword">virtual</span> <span class="keywordtype">void</span> <a class="code" href="classMcMd_1_1McModule.html#ae03d13b426df81f689966bc9cb831b85">addFactories</a>() = 0;</div><div class="line"></div><div class="line"><span class="keyword">protected</span>:</div><div class="line"></div><div class="line">   McSimulation&amp; <a class="code" href="classMcMd_1_1McModule.html#a7e8223c7c9c918e7e587cd9e9a7c7a9a">simulation</a>();</div><div class="line">   McSystem&amp;     <a class="code" href="classMcMd_1_1McModule.html#ace45568b57b318530e8d5fc54c9a2c66">system</a>();</div><div class="line"></div><div class="line">}</div></div><!-- fragment --><p> In each subclass of <a class="el" href="classMcMd_1_1McModule.html" title="Abstract Module for an McSimulation. ">McModule</a>, the implementation of the pure virtual addFactories() method must add a set of factories to the simulation, using the methods of the parent <a class="el" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem. ">McSimulation</a> and system objects. Normally, instances of the new factory factory classes are created in the constructor of the <a class="el" href="classMcMd_1_1McModule.html" title="Abstract Module for an McSimulation. ">McModule</a> subclass, and destroyed in its destructor. The protected methods simulation() and system() return references to the parent <a class="el" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem. ">McSimulation</a> and <a class="el" href="classMcMd_1_1McSystem.html" title="A System for use in a Markov chain Monte Carlo simulation. ">McSystem</a>, for use in the implementation of addFactories() by subclasses.</p>
<p>The class definition for an <a class="el" href="classMcMd_1_1MdSimulation.html" title="A molecular dynamics simulation of a single MdSystem. ">MdSimulation</a> is almost identical, except for the replacement of <a class="el" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem. ">McSimulation</a> and <a class="el" href="classMcMd_1_1McSystem.html" title="A System for use in a Markov chain Monte Carlo simulation. ">McSystem</a> typenames by <a class="el" href="classMcMd_1_1MdSimulation.html" title="A molecular dynamics simulation of a single MdSystem. ">MdSimulation</a> and <a class="el" href="classMcMd_1_1MdSystem.html" title="A System for Molecular Dynamics simulation. ">MdSystem</a> throughout.</p>
<p>The following example is used in what follows: Imagine that a user/developer writes a set of <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules. ">Species</a> and <a class="el" href="classMcMd_1_1McMove.html" title="McMove is an abstract base class for Monte Carlo moves. ">McMove</a> classes that allow efficient MC simulation of star polymers. Imagine, further, that he or she defines Factory classes named StarSpeciesFactory and StarMcMoveFactory, and packages them in a subclass of <a class="el" href="classMcMd_1_1McModule.html" title="Abstract Module for an McSimulation. ">McModule</a> named StarMcModule.</p>
<h1><a class="anchor" id="module_use_sec"></a>
Using a Module (public interface)</h1>
<p>Here is an example of a simple main MC program that uses an an instance of the StarmcModule class discussed above. </p><div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceMcMd.html">McMd</a></div><div class="line">{</div><div class="line"></div><div class="line">   <span class="keywordtype">int</span> main </div><div class="line">   {</div><div class="line">      McSimulation  sim;</div><div class="line">      StarMcModule    module(sim);</div><div class="line"></div><div class="line">      module.addFactories();</div><div class="line"></div><div class="line">      sim.readParam();</div><div class="line">  </div><div class="line">      sim.readCommands();</div><div class="line">  </div><div class="line">   }</div><div class="line"></div><div class="line">}</div></div><!-- fragment --><p> In this example, the constructor for the StarMcModule must create an instance of StarSpeciesFactory and StarMcMove Factory, which are then added to the simulation by the addFactories() method.</p>
<p>The addFactories() method of a module must be called in the main program before the readParam() method of the main <a class="el" href="classMcMd_1_1McSimulation.html" title="A Monte-Carlo simulation of one McSystem. ">McSimulation</a> or <a class="el" href="classMcMd_1_1MdSimulation.html" title="A molecular dynamics simulation of a single MdSystem. ">MdSimulation</a> object, because the custom factories created by the module are used to help parse the parameter file.</p>
<h1><a class="anchor" id="module_create_sec"></a>
Implementing a Module</h1>
<p>We now discuss how to implement a new module. Using the above example, imagine that a developer has already written and debugged several subclasses of <a class="el" href="classMcMd_1_1Species.html" title="A Species represents a set of chemically similar molecules. ">Species</a> and <a class="el" href="classMcMd_1_1McMove.html" title="McMove is an abstract base class for Monte Carlo moves. ">McMove</a>, as well as two associated factory classes named StarSpeciesFactory and StarMcMoveFactory. He or she now wants to bundle these two factories into a <a class="el" href="classMcMd_1_1McModule.html" title="Abstract Module for an McSimulation. ">McModule</a> named StarMcModule. The required definition of McStarModule might look like this: </p><div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceMcMd.html">McMd</a></div><div class="line">{</div><div class="line"></div><div class="line">   <span class="keyword">class </span>McStarModule : <span class="keyword">public</span> McModule </div><div class="line">   {</div><div class="line"></div><div class="line">   <span class="keyword">public</span>:</div><div class="line"></div><div class="line">      McStarModule(McSimulation&amp; simulation);</div><div class="line"></div><div class="line">      McStarModule();</div><div class="line"></div><div class="line">      <span class="keyword">virtual</span> <span class="keywordtype">void</span> addFactories();</div><div class="line"></div><div class="line">   <span class="keyword">private</span>:</div><div class="line"></div><div class="line">      Factory&lt;Species&gt;* speciesFactoryPtr_;</div><div class="line"></div><div class="line">      Factory&lt;McMove&gt;*  mcMoveFactoryPtr_;</div><div class="line"></div><div class="line">   }</div><div class="line"></div><div class="line">}</div></div><!-- fragment --><p> with a minimal implementation </p><div class="fragment"><div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceMcMd.html">McMd</a></div><div class="line">{</div><div class="line"></div><div class="line">   <span class="comment">// Constructor</span></div><div class="line">   StarModule::StarModule(McSimulation&amp; simulation)</div><div class="line">    : McModule(simulation),</div><div class="line">      speciesFactoryPtr_(0),</div><div class="line">      mcMoveFactoryPtr_(0)</div><div class="line">   {</div><div class="line">      speciesFactoryPtr_ = <span class="keyword">new</span> StarSpeciesFactory(simulation);</div><div class="line">      mcMoveFactoryPtr_  = <span class="keyword">new</span> StarMcMoveFactory(simulation);</div><div class="line">   }</div><div class="line"></div><div class="line">   <span class="comment">// Destructor</span></div><div class="line">   StarModule::StarModule()</div><div class="line">   {</div><div class="line">      <span class="keyword">delete</span> speciesFactoryPtr_;</div><div class="line">      <span class="keyword">delete</span> mcMoveFactoryPtr_;</div><div class="line">   }</div><div class="line"></div><div class="line">   StarModule::addFactories()</div><div class="line">   {</div><div class="line">      simulation().speciesFactory().addSubfactory(*speciesFactoryPtr_);</div><div class="line">      simulation().mcMoveFactory().addSubfactory(*mcMoveFactoryPtr_);</div><div class="line">   }</div><div class="line"></div><div class="line">}</div></div><!-- fragment --><p> Here, the StarMcModule constructor creates one instance of each of the two required factory classes, which are deleted in the destructor. The addFactories() method must then add each of these factories as a subfactory to a default factory owned by the main simulation object, using the appropriate accessors and addSubfactory() methods of the default factory objects.</p>
<p>The main benefit of writing a module is that it encapsulates the creation and destruction of several closely related factory objects, and allows a user to add these factories to a simulation with a single line of code. The creation of a module class can be convenient, but is not necessary.</p>
<p><br />
 <a class="el" href="extend_subfactory_page.html">4.5 Sub-Factories</a> (Prev) &#160; &#160; &#160; &#160; <a class="el" href="extend_page.html">4 Extending Simpatico</a> (Up) &#160; &#160; &#160; &#160; <a class="el" href="developer_page.html">5 Developer Information</a> (Next) </p>
</div></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.3-->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated on Sun Jan 8 2017 23:13:22 for Simpatico by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.11
</small></address>
</body>
</html>
